{"version":3,"sources":["webpack:///./node_modules/core-js/internals/string-repeat.js","webpack:///./node_modules/core-js/modules/es.string.repeat.js","webpack:///./node_modules/three/examples/jsm/controls/OrbitControls.js","webpack:///./src/page/three/plugins/terrain.png","webpack:///./src/page/three/plugins/texture.png","webpack:///./src/page/three/threeTerrain.vue?373f","webpack:///./src/page/three/plugins/Terrains.js","webpack:///src/page/three/threeTerrain.vue","webpack:///./src/page/three/threeTerrain.vue?e61e","webpack:///./src/page/three/threeTerrain.vue"],"names":["toInteger","requireObjectCoercible","module","exports","repeat","count","str","String","this","result","n","Infinity","RangeError","$","target","proto","OrbitControls","object","domElement","undefined","console","warn","document","error","enabled","minDistance","maxDistance","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TWO","DOLLY_PAN","target0","clone","position0","position","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","applyQuaternion","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","max","min","makeSafe","radius","scale","addScaledVector","panOffset","add","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","type","startEvent","endEvent","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","length","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","event","clientX","clientY","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","subVectors","x","y","handleMouseMoveDolly","handleMouseMovePan","handleMouseUp","handleMouseWheel","handleKeyDown","needsUpdate","keyCode","preventDefault","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveRotate","handleTouchMovePan","handleTouchMoveDolly","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","handleTouchEnd","focus","window","button","ctrlKey","metaKey","shiftKey","addEventListener","stopPropagation","DOLLY_ROTATE","tabIndex","prototype","Object","create","constructor","MapControls","call","render","_vm","_h","$createElement","_c","_self","ref","staticStyle","style","staticRenderFns","Terrains","width","height","geometry","THREE","rotation","makeRotationX","applyMatrix","array","attributes","mesh","texture","computeBoundingSphere","computeVertexNormals","material","map","z","Error","ix","floor","iz","rx","rz","a","b","c","d","e","f","src","Promise","resolve","reject","img","Image","onload","canvas","createElement","ctx","getContext","drawImage","pixels","getImageData","data","terrain","i","onabort","onerror","name","controll","renderer","camera","scene","path","cameraOpt","mounted","init","methods","initRenderer","inirCamera","initControll","initScene","addData","animation","requestAnimationFrame","$refs","container","setSize","w","h","light","normalize","fog","setClearColor","color","wrapS","wrapT","terrains","component"],"mappings":"gHACA,IAAIA,EAAY,EAAQ,QACpBC,EAAyB,EAAQ,QAIrCC,EAAOC,QAAU,GAAGC,QAAU,SAAgBC,GAC5C,IAAIC,EAAMC,OAAON,EAAuBO,OACpCC,EAAS,GACTC,EAAIV,EAAUK,GAClB,GAAIK,EAAI,GAAKA,GAAKC,IAAU,MAAMC,WAAW,+BAC7C,KAAMF,EAAI,GAAIA,KAAO,KAAOJ,GAAOA,GAAc,EAAJI,IAAOD,GAAUH,GAC9D,OAAOG,I,uBCZT,IAAII,EAAI,EAAQ,QACZT,EAAS,EAAQ,QAIrBS,EAAE,CAAEC,OAAQ,SAAUC,OAAO,GAAQ,CACnCX,OAAQA,K,kCCNV,kDA0BIY,EAAgB,SAAWC,EAAQC,QAElBC,IAAfD,GAA2BE,QAAQC,KAAM,4EACzCH,IAAeI,UAAWF,QAAQG,MAAO,4HAE9Cf,KAAKS,OAASA,EACdT,KAAKU,WAAaA,EAGlBV,KAAKgB,SAAU,EAGfhB,KAAKM,OAAS,IAAI,QAGlBN,KAAKiB,YAAc,EACnBjB,KAAKkB,YAAcf,IAGnBH,KAAKmB,QAAU,EACfnB,KAAKoB,QAAUjB,IAIfH,KAAKqB,cAAgB,EACrBrB,KAAKsB,cAAgBC,KAAKC,GAI1BxB,KAAKyB,iBAAoBtB,IACzBH,KAAK0B,gBAAkBvB,IAIvBH,KAAK2B,eAAgB,EACrB3B,KAAK4B,cAAgB,IAIrB5B,KAAK6B,YAAa,EAClB7B,KAAK8B,UAAY,EAGjB9B,KAAK+B,cAAe,EACpB/B,KAAKgC,YAAc,EAGnBhC,KAAKiC,WAAY,EACjBjC,KAAKkC,SAAW,EAChBlC,KAAKmC,oBAAqB,EAC1BnC,KAAKoC,YAAc,EAInBpC,KAAKqC,YAAa,EAClBrC,KAAKsC,gBAAkB,EAGvBtC,KAAKuC,YAAa,EAGlBvC,KAAKwC,KAAO,CAAEC,KAAM,GAAIC,GAAI,GAAIC,MAAO,GAAIC,OAAQ,IAGnD5C,KAAK6C,aAAe,CAAEJ,KAAM,OAAMK,OAAQC,OAAQ,OAAMC,MAAOL,MAAO,OAAMM,KAG5EjD,KAAKkD,QAAU,CAAEC,IAAK,QAAML,OAAQM,IAAK,QAAMC,WAG/CrD,KAAKsD,QAAUtD,KAAKM,OAAOiD,QAC3BvD,KAAKwD,UAAYxD,KAAKS,OAAOgD,SAASF,QACtCvD,KAAK0D,MAAQ1D,KAAKS,OAAOkD,KAMzB3D,KAAK4D,cAAgB,WAEpB,OAAOC,EAAUC,KAIlB9D,KAAK+D,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBhE,KAAKiE,UAAY,WAEhBC,EAAMZ,QAAQa,KAAMD,EAAM5D,QAC1B4D,EAAMV,UAAUW,KAAMD,EAAMzD,OAAOgD,UACnCS,EAAMR,MAAQQ,EAAMzD,OAAOkD,MAI5B3D,KAAKoE,MAAQ,WAEZF,EAAM5D,OAAO6D,KAAMD,EAAMZ,SACzBY,EAAMzD,OAAOgD,SAASU,KAAMD,EAAMV,WAClCU,EAAMzD,OAAOkD,KAAOO,EAAMR,MAE1BQ,EAAMzD,OAAO4D,yBACbH,EAAMI,cAAeC,GAErBL,EAAMM,SAENC,EAAQC,EAAMC,MAKf3E,KAAKwE,OAAS,WAEb,IAAII,EAAS,IAAI,QAGbC,GAAO,IAAI,SAAaC,mBAAoBrE,EAAOsE,GAAI,IAAI,QAAS,EAAG,EAAG,IAC1EC,EAAcH,EAAKtB,QAAQ0B,UAE3BC,EAAe,IAAI,QACnBC,EAAiB,IAAI,QAEzB,OAAO,WAEN,IAAI1B,EAAWS,EAAMzD,OAAOgD,SAoF5B,OAlFAmB,EAAOT,KAAMV,GAAW2B,IAAKlB,EAAM5D,QAGnCsE,EAAOS,gBAAiBR,GAGxBhB,EAAUyB,eAAgBV,GAErBV,EAAM7B,YAAcoC,IAAUC,EAAMC,MAExCY,EAAYC,KAIRtB,EAAMvC,eAEVkC,EAAUG,OAASyB,EAAezB,MAAQE,EAAMtC,cAChDiC,EAAUC,KAAO2B,EAAe3B,IAAMI,EAAMtC,gBAI5CiC,EAAUG,OAASyB,EAAezB,MAClCH,EAAUC,KAAO2B,EAAe3B,KAKjCD,EAAUG,MAAQzC,KAAKmE,IAAKxB,EAAMzC,gBAAiBF,KAAKoE,IAAKzB,EAAMxC,gBAAiBmC,EAAUG,QAG9FH,EAAUC,IAAMvC,KAAKmE,IAAKxB,EAAM7C,cAAeE,KAAKoE,IAAKzB,EAAM5C,cAAeuC,EAAUC,MAExFD,EAAU+B,WAGV/B,EAAUgC,QAAUC,EAGpBjC,EAAUgC,OAAStE,KAAKmE,IAAKxB,EAAMjD,YAAaM,KAAKoE,IAAKzB,EAAMhD,YAAa2C,EAAUgC,UAI1D,IAAxB3B,EAAMvC,cAEVuC,EAAM5D,OAAOyF,gBAAiBC,EAAW9B,EAAMtC,eAI/CsC,EAAM5D,OAAO2F,IAAKD,GAInBpB,EAAOsB,iBAAkBrC,GAGzBe,EAAOS,gBAAiBL,GAExBvB,EAASU,KAAMD,EAAM5D,QAAS2F,IAAKrB,GAEnCV,EAAMzD,OAAO0F,OAAQjC,EAAM5D,SAEE,IAAxB4D,EAAMvC,eAEV8D,EAAezB,OAAW,EAAIE,EAAMtC,cACpC6D,EAAe3B,KAAS,EAAII,EAAMtC,cAElCoE,EAAUI,eAAgB,EAAIlC,EAAMtC,iBAIpC6D,EAAeY,IAAK,EAAG,EAAG,GAE1BL,EAAUK,IAAK,EAAG,EAAG,IAItBP,EAAQ,KAMHQ,GACJpB,EAAaqB,kBAAmBrC,EAAMzD,OAAOgD,UAAa+C,GAC1D,GAAM,EAAIrB,EAAesB,IAAKvC,EAAMzD,OAAOiG,aAAiBF,KAE5DtC,EAAMI,cAAeC,GAErBW,EAAaf,KAAMD,EAAMzD,OAAOgD,UAChC0B,EAAehB,KAAMD,EAAMzD,OAAOiG,YAClCJ,GAAc,GAEP,IA3GI,GAqHdtG,KAAK2G,QAAU,WAEdzC,EAAMxD,WAAWkG,oBAAqB,cAAeC,IAAe,GACpE3C,EAAMxD,WAAWkG,oBAAqB,YAAaE,GAAa,GAChE5C,EAAMxD,WAAWkG,oBAAqB,QAASG,IAAc,GAE7D7C,EAAMxD,WAAWkG,oBAAqB,aAAcI,IAAc,GAClE9C,EAAMxD,WAAWkG,oBAAqB,WAAYK,IAAY,GAC9D/C,EAAMxD,WAAWkG,oBAAqB,YAAaM,IAAa,GAEhEpG,SAAS8F,oBAAqB,YAAaO,IAAa,GACxDrG,SAAS8F,oBAAqB,UAAWQ,IAAW,GAEpDlD,EAAMxD,WAAWkG,oBAAqB,UAAWS,IAAW,IAU7D,IAAInD,EAAQlE,KAERuE,EAAc,CAAE+C,KAAM,UACtBC,EAAa,CAAED,KAAM,SACrBE,EAAW,CAAEF,KAAM,OAEnB5C,EAAQ,CACXC,MAAQ,EACR7B,OAAQ,EACRE,MAAO,EACPC,IAAK,EACLwE,aAAc,EACdC,UAAW,EACXC,gBAAiB,EACjBC,mBAAoB,GAGjBnD,EAAQC,EAAMC,KAEd6B,EAAM,KAGN3C,EAAY,IAAI,QAChB4B,EAAiB,IAAI,QAErBK,EAAQ,EACRE,EAAY,IAAI,QAChBM,GAAc,EAEduB,EAAc,IAAI,QAClBC,EAAY,IAAI,QAChBC,EAAc,IAAI,QAElBC,EAAW,IAAI,QACfC,EAAS,IAAI,QACbC,EAAW,IAAI,QAEfC,EAAa,IAAI,QACjBC,EAAW,IAAI,QACfC,EAAa,IAAI,QAErB,SAAS7C,IAER,OAAO,EAAIjE,KAAKC,GAAK,GAAK,GAAK0C,EAAM5B,gBAItC,SAASgG,IAER,OAAO/G,KAAKgH,IAAK,IAAMrE,EAAMpC,WAI9B,SAASyD,EAAYiD,GAEpB/C,EAAezB,OAASwE,EAIzB,SAASC,EAAUD,GAElB/C,EAAe3B,KAAO0E,EAIvB,IAAIE,EAAU,WAEb,IAAIC,EAAI,IAAI,QAEZ,OAAO,SAAkBC,EAAUC,GAElCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAEvC,gBAAkBwC,GAEpB5C,EAAUC,IAAK0C,IATH,GAeVI,EAAQ,WAEX,IAAIJ,EAAI,IAAI,QAEZ,OAAO,SAAgBC,EAAUC,IAEE,IAA7B3E,EAAM/B,mBAEVwG,EAAEG,oBAAqBD,EAAc,IAIrCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAEK,aAAc9E,EAAMzD,OAAOsE,GAAI4D,IAIlCA,EAAEvC,eAAgBwC,GAElB5C,EAAUC,IAAK0C,IAnBL,GA0BRM,EAAM,WAET,IAAIrE,EAAS,IAAI,QAEjB,OAAO,SAAcsE,EAAQC,GAE5B,IAAIC,EAAUlF,EAAMxD,WAEpB,GAAKwD,EAAMzD,OAAO4I,oBAAsB,CAGvC,IAAI5F,EAAWS,EAAMzD,OAAOgD,SAC5BmB,EAAOT,KAAMV,GAAW2B,IAAKlB,EAAM5D,QACnC,IAAIgJ,EAAiB1E,EAAO2E,SAG5BD,GAAkB/H,KAAKiI,IAAOtF,EAAMzD,OAAOgJ,IAAM,EAAMlI,KAAKC,GAAK,KAGjEkH,EAAS,EAAIQ,EAASI,EAAiBF,EAAQM,aAAcxF,EAAMzD,OAAOkJ,QAC1EZ,EAAO,EAAII,EAASG,EAAiBF,EAAQM,aAAcxF,EAAMzD,OAAOkJ,aAE7DzF,EAAMzD,OAAOmJ,sBAGxBlB,EAASQ,GAAWhF,EAAMzD,OAAOoJ,MAAQ3F,EAAMzD,OAAOqJ,MAAS5F,EAAMzD,OAAOkD,KAAOyF,EAAQW,YAAa7F,EAAMzD,OAAOkJ,QACrHZ,EAAOI,GAAWjF,EAAMzD,OAAOuJ,IAAM9F,EAAMzD,OAAOwJ,QAAW/F,EAAMzD,OAAOkD,KAAOyF,EAAQM,aAAcxF,EAAMzD,OAAOkJ,UAKpH/I,QAAQC,KAAM,gFACdqD,EAAMjC,WAAY,IAhCX,GAwCV,SAASiI,EAASC,GAEZjG,EAAMzD,OAAO4I,oBAEjBvD,GAASqE,EAEEjG,EAAMzD,OAAOmJ,sBAExB1F,EAAMzD,OAAOkD,KAAOpC,KAAKmE,IAAKxB,EAAM/C,QAASI,KAAKoE,IAAKzB,EAAM9C,QAAS8C,EAAMzD,OAAOkD,KAAOwG,IAC1FjG,EAAMzD,OAAO4D,yBACbiC,GAAc,IAId1F,QAAQC,KAAM,uFACdqD,EAAMrC,YAAa,GAMrB,SAASuI,EAAUD,GAEbjG,EAAMzD,OAAO4I,oBAEjBvD,GAASqE,EAEEjG,EAAMzD,OAAOmJ,sBAExB1F,EAAMzD,OAAOkD,KAAOpC,KAAKmE,IAAKxB,EAAM/C,QAASI,KAAKoE,IAAKzB,EAAM9C,QAAS8C,EAAMzD,OAAOkD,KAAOwG,IAC1FjG,EAAMzD,OAAO4D,yBACbiC,GAAc,IAId1F,QAAQC,KAAM,uFACdqD,EAAMrC,YAAa,GAUrB,SAASwI,EAAuBC,GAE/BzC,EAAYxB,IAAKiE,EAAMC,QAASD,EAAME,SAIvC,SAASC,EAAsBH,GAE9BnC,EAAW9B,IAAKiE,EAAMC,QAASD,EAAME,SAItC,SAASE,EAAoBJ,GAE5BtC,EAAS3B,IAAKiE,EAAMC,QAASD,EAAME,SAIpC,SAASG,EAAuBL,GAE/BxC,EAAUzB,IAAKiE,EAAMC,QAASD,EAAME,SAEpCzC,EAAY6C,WAAY9C,EAAWD,GAAczB,eAAgBlC,EAAMlC,aAEvE,IAAIoH,EAAUlF,EAAMxD,WAEpB6E,EAAY,EAAIhE,KAAKC,GAAKuG,EAAY8C,EAAIzB,EAAQM,cAElDjB,EAAU,EAAIlH,KAAKC,GAAKuG,EAAY+C,EAAI1B,EAAQM,cAEhD7B,EAAY1D,KAAM2D,GAElB5D,EAAMM,SAIP,SAASuG,EAAsBT,GAE9BlC,EAAS/B,IAAKiE,EAAMC,QAASD,EAAME,SAEnCnC,EAAWuC,WAAYxC,EAAUD,GAE5BE,EAAWyC,EAAI,EAEnBZ,EAAS5B,KAEED,EAAWyC,EAAI,GAE1BV,EAAU9B,KAIXH,EAAWhE,KAAMiE,GAEjBlE,EAAMM,SAIP,SAASwG,EAAoBV,GAE5BrC,EAAO5B,IAAKiE,EAAMC,QAASD,EAAME,SAEjCtC,EAAS0C,WAAY3C,EAAQD,GAAW5B,eAAgBlC,EAAMhC,UAE9D+G,EAAKf,EAAS2C,EAAG3C,EAAS4C,GAE1B9C,EAAS7D,KAAM8D,GAEf/D,EAAMM,SAIP,SAASyG,KAMT,SAASC,EAAkBZ,GAErBA,EAAMnB,OAAS,EAEnBiB,EAAU9B,KAECgC,EAAMnB,OAAS,GAE1Be,EAAS5B,KAIVpE,EAAMM,SAIP,SAAS2G,EAAeb,GAEvB,IAAIc,GAAc,EAElB,OAASd,EAAMe,SAEd,KAAKnH,EAAM1B,KAAKE,GACfuG,EAAK,EAAG/E,EAAM9B,aACdgJ,GAAc,EACd,MAED,KAAKlH,EAAM1B,KAAKI,OACfqG,EAAK,GAAK/E,EAAM9B,aAChBgJ,GAAc,EACd,MAED,KAAKlH,EAAM1B,KAAKC,KACfwG,EAAK/E,EAAM9B,YAAa,GACxBgJ,GAAc,EACd,MAED,KAAKlH,EAAM1B,KAAKG,MACfsG,GAAO/E,EAAM9B,YAAa,GAC1BgJ,GAAc,EACd,MAIGA,IAGJd,EAAMgB,iBAENpH,EAAMM,UAOR,SAAS+G,EAAwBjB,GAEhC,GAA6B,GAAxBA,EAAMpH,QAAQqG,OAElB1B,EAAYxB,IAAKiE,EAAMpH,QAAS,GAAIsI,MAAOlB,EAAMpH,QAAS,GAAIuI,WAExD,CAEN,IAAIZ,EAAI,IAAQP,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,OAC1DV,EAAI,IAAQR,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,OAE9D5D,EAAYxB,IAAKwE,EAAGC,IAMtB,SAASY,EAAqBpB,GAE7B,GAA6B,GAAxBA,EAAMpH,QAAQqG,OAElBvB,EAAS3B,IAAKiE,EAAMpH,QAAS,GAAIsI,MAAOlB,EAAMpH,QAAS,GAAIuI,WAErD,CAEN,IAAIZ,EAAI,IAAQP,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,OAC1DV,EAAI,IAAQR,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,OAE9DzD,EAAS3B,IAAKwE,EAAGC,IAMnB,SAASa,EAAuBrB,GAE/B,IAAIsB,EAAKtB,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,MACnDK,EAAKvB,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,MAEnD7C,EAAWrH,KAAKuK,KAAMF,EAAKA,EAAKC,EAAKA,GAEzC1D,EAAW9B,IAAK,EAAGuC,GAIpB,SAASmD,EAA0BzB,GAE7BpG,EAAMrC,YAAa8J,EAAuBrB,GAE1CpG,EAAMjC,WAAYyJ,EAAqBpB,GAI7C,SAAS0B,EAA6B1B,GAEhCpG,EAAMrC,YAAa8J,EAAuBrB,GAE1CpG,EAAMnC,cAAewJ,EAAwBjB,GAInD,SAAS2B,EAAuB3B,GAE/B,GAA6B,GAAxBA,EAAMpH,QAAQqG,OAElBzB,EAAUzB,IAAKiE,EAAMpH,QAAS,GAAIsI,MAAOlB,EAAMpH,QAAS,GAAIuI,WAEtD,CAEN,IAAIZ,EAAI,IAAQP,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,OAC1DV,EAAI,IAAQR,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,OAE9D3D,EAAUzB,IAAKwE,EAAGC,GAInB/C,EAAY6C,WAAY9C,EAAWD,GAAczB,eAAgBlC,EAAMlC,aAEvE,IAAIoH,EAAUlF,EAAMxD,WAEpB6E,EAAY,EAAIhE,KAAKC,GAAKuG,EAAY8C,EAAIzB,EAAQM,cAElDjB,EAAU,EAAIlH,KAAKC,GAAKuG,EAAY+C,EAAI1B,EAAQM,cAEhD7B,EAAY1D,KAAM2D,GAInB,SAASoE,EAAoB5B,GAE5B,GAA6B,GAAxBA,EAAMpH,QAAQqG,OAElBtB,EAAO5B,IAAKiE,EAAMpH,QAAS,GAAIsI,MAAOlB,EAAMpH,QAAS,GAAIuI,WAEnD,CAEN,IAAIZ,EAAI,IAAQP,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,OAC1DV,EAAI,IAAQR,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,OAE9DxD,EAAO5B,IAAKwE,EAAGC,GAIhB5C,EAAS0C,WAAY3C,EAAQD,GAAW5B,eAAgBlC,EAAMhC,UAE9D+G,EAAKf,EAAS2C,EAAG3C,EAAS4C,GAE1B9C,EAAS7D,KAAM8D,GAIhB,SAASkE,EAAsB7B,GAE9B,IAAIsB,EAAKtB,EAAMpH,QAAS,GAAIsI,MAAQlB,EAAMpH,QAAS,GAAIsI,MACnDK,EAAKvB,EAAMpH,QAAS,GAAIuI,MAAQnB,EAAMpH,QAAS,GAAIuI,MAEnD7C,EAAWrH,KAAKuK,KAAMF,EAAKA,EAAKC,EAAKA,GAEzCzD,EAAS/B,IAAK,EAAGuC,GAEjBP,EAAWhC,IAAK,EAAG9E,KAAKgH,IAAKH,EAAS0C,EAAI3C,EAAW2C,EAAG5G,EAAMpC,YAE9DoI,EAAS7B,EAAWyC,GAEpB3C,EAAWhE,KAAMiE,GAIlB,SAASgE,EAAyB9B,GAE5BpG,EAAMrC,YAAasK,EAAsB7B,GAEzCpG,EAAMjC,WAAYiK,EAAoB5B,GAI5C,SAAS+B,EAA4B/B,GAE/BpG,EAAMrC,YAAasK,EAAsB7B,GAEzCpG,EAAMnC,cAAekK,EAAuB3B,GAIlD,SAASgC,KAUT,SAASxF,EAAawD,GAErB,IAAuB,IAAlBpG,EAAMlD,QAAX,CAWA,OAPAsJ,EAAMgB,iBAKNpH,EAAMxD,WAAW6L,MAAQrI,EAAMxD,WAAW6L,QAAUC,OAAOD,QAElDjC,EAAMmC,QAEd,KAAK,EAEJ,OAASvI,EAAMrB,aAAaJ,MAE3B,KAAK,OAAMK,OAEV,GAAKwH,EAAMoC,SAAWpC,EAAMqC,SAAWrC,EAAMsC,SAAW,CAEvD,IAAyB,IAApB1I,EAAMjC,UAAsB,OAEjCyI,EAAoBJ,GAEpB7F,EAAQC,EAAMzB,QAER,CAEN,IAA4B,IAAvBiB,EAAMnC,aAAyB,OAEpCsI,EAAuBC,GAEvB7F,EAAQC,EAAM5B,OAIf,MAED,KAAK,OAAMG,IAEV,GAAKqH,EAAMoC,SAAWpC,EAAMqC,SAAWrC,EAAMsC,SAAW,CAEvD,IAA4B,IAAvB1I,EAAMnC,aAAyB,OAEpCsI,EAAuBC,GAEvB7F,EAAQC,EAAM5B,WAER,CAEN,IAAyB,IAApBoB,EAAMjC,UAAsB,OAEjCyI,EAAoBJ,GAEpB7F,EAAQC,EAAMzB,IAIf,MAED,QAECwB,EAAQC,EAAMC,KAIhB,MAGD,KAAK,EAEJ,OAAST,EAAMrB,aAAaE,QAE3B,KAAK,OAAMC,MAEV,IAA0B,IAArBkB,EAAMrC,WAAuB,OAElC4I,EAAsBH,GAEtB7F,EAAQC,EAAM1B,MAEd,MAGD,QAECyB,EAAQC,EAAMC,KAIhB,MAED,KAAK,EAEJ,OAAST,EAAMrB,aAAaF,OAE3B,KAAK,OAAMG,OAEV,IAA4B,IAAvBoB,EAAMnC,aAAyB,OAEpCsI,EAAuBC,GAEvB7F,EAAQC,EAAM5B,OAEd,MAED,KAAK,OAAMG,IAEV,IAAyB,IAApBiB,EAAMjC,UAAsB,OAEjCyI,EAAoBJ,GAEpB7F,EAAQC,EAAMzB,IAEd,MAED,QAECwB,EAAQC,EAAMC,KAIhB,MAIGF,IAAUC,EAAMC,OAEpB7D,SAAS+L,iBAAkB,YAAa1F,IAAa,GACrDrG,SAAS+L,iBAAkB,UAAWzF,IAAW,GAEjDlD,EAAMI,cAAeiD,KAMvB,SAASJ,GAAamD,GAErB,IAAuB,IAAlBpG,EAAMlD,QAIX,OAFAsJ,EAAMgB,iBAEG7G,GAER,KAAKC,EAAM5B,OAEV,IAA4B,IAAvBoB,EAAMnC,aAAyB,OAEpC4I,EAAuBL,GAEvB,MAED,KAAK5F,EAAM1B,MAEV,IAA0B,IAArBkB,EAAMrC,WAAuB,OAElCkJ,EAAsBT,GAEtB,MAED,KAAK5F,EAAMzB,IAEV,IAAyB,IAApBiB,EAAMjC,UAAsB,OAEjC+I,EAAoBV,GAEpB,OAMH,SAASlD,GAAWkD,IAEI,IAAlBpG,EAAMlD,UAEXiK,EAAeX,GAEfxJ,SAAS8F,oBAAqB,YAAaO,IAAa,GACxDrG,SAAS8F,oBAAqB,UAAWQ,IAAW,GAEpDlD,EAAMI,cAAekD,GAErB/C,EAAQC,EAAMC,MAIf,SAASoC,GAAcuD,IAEC,IAAlBpG,EAAMlD,UAA0C,IAArBkD,EAAMrC,YAA0B4C,IAAUC,EAAMC,MAAQF,IAAUC,EAAM5B,SAExGwH,EAAMgB,iBACNhB,EAAMwC,kBAEN5I,EAAMI,cAAeiD,GAErB2D,EAAkBZ,GAElBpG,EAAMI,cAAekD,IAItB,SAASH,GAAWiD,IAEI,IAAlBpG,EAAMlD,UAA0C,IAArBkD,EAAM3B,aAA4C,IAApB2B,EAAMjC,WAEpEkJ,EAAeb,GAIhB,SAAStD,GAAcsD,GAEtB,IAAuB,IAAlBpG,EAAMlD,QAAX,CAIA,OAFAsJ,EAAMgB,iBAEGhB,EAAMpH,QAAQqG,QAEtB,KAAK,EAEJ,OAASrF,EAAMhB,QAAQC,KAEtB,KAAK,QAAML,OAEV,IAA4B,IAAvBoB,EAAMnC,aAAyB,OAEpCwJ,EAAwBjB,GAExB7F,EAAQC,EAAM+C,aAEd,MAED,KAAK,QAAMxE,IAEV,IAAyB,IAApBiB,EAAMjC,UAAsB,OAEjCyJ,EAAqBpB,GAErB7F,EAAQC,EAAMgD,UAEd,MAED,QAECjD,EAAQC,EAAMC,KAIhB,MAED,KAAK,EAEJ,OAAST,EAAMhB,QAAQE,KAEtB,KAAK,QAAMC,UAEV,IAA0B,IAArBa,EAAMrC,aAA4C,IAApBqC,EAAMjC,UAAsB,OAE/D8J,EAA0BzB,GAE1B7F,EAAQC,EAAMiD,gBAEd,MAED,KAAK,QAAMoF,aAEV,IAA0B,IAArB7I,EAAMrC,aAA+C,IAAvBqC,EAAMnC,aAAyB,OAElEiK,EAA6B1B,GAE7B7F,EAAQC,EAAMkD,mBAEd,MAED,QAECnD,EAAQC,EAAMC,KAIhB,MAED,QAECF,EAAQC,EAAMC,KAIXF,IAAUC,EAAMC,MAEpBT,EAAMI,cAAeiD,IAMvB,SAASL,GAAaoD,GAErB,IAAuB,IAAlBpG,EAAMlD,QAKX,OAHAsJ,EAAMgB,iBACNhB,EAAMwC,kBAEGrI,GAER,KAAKC,EAAM+C,aAEV,IAA4B,IAAvBvD,EAAMnC,aAAyB,OAEpCkK,EAAuB3B,GAEvBpG,EAAMM,SAEN,MAED,KAAKE,EAAMgD,UAEV,IAAyB,IAApBxD,EAAMjC,UAAsB,OAEjCiK,EAAoB5B,GAEpBpG,EAAMM,SAEN,MAED,KAAKE,EAAMiD,gBAEV,IAA0B,IAArBzD,EAAMrC,aAA4C,IAApBqC,EAAMjC,UAAsB,OAE/DmK,EAAyB9B,GAEzBpG,EAAMM,SAEN,MAED,KAAKE,EAAMkD,mBAEV,IAA0B,IAArB1D,EAAMrC,aAA+C,IAAvBqC,EAAMnC,aAAyB,OAElEsK,EAA4B/B,GAE5BpG,EAAMM,SAEN,MAED,QAECC,EAAQC,EAAMC,MAMjB,SAASsC,GAAYqD,IAEG,IAAlBpG,EAAMlD,UAEXsL,EAAgBhC,GAEhBpG,EAAMI,cAAekD,GAErB/C,EAAQC,EAAMC,MAIf,SAASkC,GAAeyD,IAEA,IAAlBpG,EAAMlD,SAEXsJ,EAAMgB,iBAMPpH,EAAMxD,WAAWmM,iBAAkB,cAAehG,IAAe,GAEjE3C,EAAMxD,WAAWmM,iBAAkB,YAAa/F,GAAa,GAC7D5C,EAAMxD,WAAWmM,iBAAkB,QAAS9F,IAAc,GAE1D7C,EAAMxD,WAAWmM,iBAAkB,aAAc7F,IAAc,GAC/D9C,EAAMxD,WAAWmM,iBAAkB,WAAY5F,IAAY,GAC3D/C,EAAMxD,WAAWmM,iBAAkB,YAAa3F,IAAa,GAE7DhD,EAAMxD,WAAWmM,iBAAkB,UAAWxF,IAAW,IAIpB,IAAhCnD,EAAMxD,WAAWsM,WAErB9I,EAAMxD,WAAWsM,SAAW,GAM7BhN,KAAKwE,UAINhE,EAAcyM,UAAYC,OAAOC,OAAQ,OAAgBF,WACzDzM,EAAcyM,UAAUG,YAAc5M,EAWtC,IAAI6M,EAAc,SAAW5M,EAAQC,GAEpCF,EAAc8M,KAAMtN,KAAMS,EAAQC,GAElCV,KAAK6C,aAAaJ,KAAO,OAAMQ,IAC/BjD,KAAK6C,aAAaF,MAAQ,OAAMG,OAEhC9C,KAAKkD,QAAQC,IAAM,QAAMF,IACzBjD,KAAKkD,QAAQE,IAAM,QAAM2J,cAI1BM,EAAYJ,UAAYC,OAAOC,OAAQ,OAAgBF,WACvDI,EAAYJ,UAAUG,YAAcC,G,qBCrqCpC3N,EAAOC,QAAU,IAA0B,4B,qBCA3CD,EAAOC,QAAU,IAA0B,4B,yCCA3C,IAAI4N,EAAS,WAAa,IAAIC,EAAIxN,KAASyN,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACE,IAAI,YAAYC,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQC,MAAM,MAC5KC,EAAkB,G,wECAhBC,E,WACJ,WAAYC,EAAOC,GAAQ,uBACzBnO,KAAKkO,MAAQA,EACblO,KAAKmO,OAASA,EACdnO,KAAKoO,SAAW,IAAIC,QAClBH,EACAC,EACAD,EAAQ,EACRC,EAAS,GAEX,IAAIG,GAAW,IAAID,QAAgBE,eAAehN,KAAKC,GAAK,GAC5DxB,KAAKoO,SAASI,YAAYF,GAC1BtO,KAAKyO,MAAQzO,KAAKoO,SAASM,WAAWjL,SAASgL,MAC/CzO,KAAK2O,KAAO,K,qDA0BRC,GASJ,OARA5O,KAAKoO,SAASS,wBACd7O,KAAKoO,SAASU,uBACd9O,KAAK+O,SAAW,IAAIV,OAA0B,CAC5CW,IAAKJ,IAEP5O,KAAK2O,KAAO,IAAIN,OAAWrO,KAAKoO,SAAUpO,KAAK+O,UAC/C/O,KAAK2O,KAAKlL,SAASoH,EAAI7K,KAAKkO,MAAQ,EACpClO,KAAK2O,KAAKlL,SAASwL,EAAIjP,KAAKmO,OAAS,EAC9BnO,KAAK2O,O,kCAGF9D,EAAGoE,GA2Bb,IAAIf,EAAQlO,KAAKkO,MACbC,EAASnO,KAAKmO,OAClB,GAAItD,EAAI,GAAKA,GAAKqD,GAASe,EAAI,GAAKA,GAAKd,EACvC,MAAM,IAAIe,MAAM,qCAGlB,IAAIC,EAAK5N,KAAK6N,MAAMvE,GAChBwE,EAAK9N,KAAK6N,MAAMH,GAGhBK,EAAKzE,EAAIsE,EACTI,EAAKN,EAAII,EAETG,EAAIxP,KAAKyO,MAA0B,GAAnBY,EAAKnB,EAAQiB,GAAU,GACvCM,EAAIzP,KAAKyO,MAAgC,GAAzBY,EAAKnB,GAASiB,EAAK,IAAU,GAC7CO,EAAI1P,KAAKyO,MAAsC,IAA9BY,EAAK,GAAKnB,GAASiB,EAAK,IAAU,GACnDQ,EAAI3P,KAAKyO,MAAgC,IAAxBY,EAAK,GAAKnB,EAAQiB,GAAU,GAE7CS,EAAIJ,GAAK,EAAIF,GAAMG,EAAIH,EAEvBO,EAAIH,EAAIJ,EAAKK,GAAK,EAAIL,GAEtBxE,EAAI8E,GAAK,EAAIL,GAAMM,EAAIN,EAC3B,OAAOzE,K,iCAtFQgF,GACf,OAAO,IAAIC,SAAQ,SAASC,EAASC,GACnC,IAAIC,EAAM,IAAIC,MACdD,EAAIE,OAAS,WACX,IAAIlC,EAAQgC,EAAIhC,MACZC,EAAS+B,EAAI/B,OACbkC,EAASvP,SAASwP,cAAc,UACpCD,EAAOnC,MAAQA,EACfmC,EAAOlC,OAASA,EAChB,IAAIoC,EAAMF,EAAOG,WAAW,MAC5BD,EAAIE,UAAUP,EAAK,EAAG,GAGtB,IAFA,IAAIQ,EAASH,EAAII,aAAa,EAAG,EAAGzC,EAAOC,GAAQyC,KAC/CC,EAAU,IAAI5C,EAASC,EAAOC,GACzB2C,EAAI,EAAGA,EAAI5C,EAAQC,EAAQ2C,IAClCD,EAAQpC,MAAU,EAAJqC,EAAQ,GAAKJ,EAAW,EAAJI,GAAS,IAE7Cd,EAAQa,IAEVX,EAAIa,QAAUd,EACdC,EAAIc,QAAUf,EACdC,EAAIJ,IAAMA,S,KAqED7B,ICjGf,GACEgD,KAAM,eACNL,KAFF,WAGI,MAAO,CACLM,SAAU,KACVC,SAAU,KACVC,OAAQ,KACRC,MAAO,KACPC,KAAM,EAAZ,QACM1C,QAAS,EAAf,QACM2C,UAAW,CACT/I,MAAO,GACP7C,IAAK,GACLD,IAAK,OAIX8L,QAjBF,WAkBIxR,KAAKyR,QAEPC,QAAS,CACPD,KADJ,WAEMzR,KAAK2R,eACL3R,KAAK4R,aACL5R,KAAK6R,eACL7R,KAAK8R,YACL9R,KAAK+R,QAAQ/R,KAAKsR,KAAMtR,KAAK4O,SAC7B5O,KAAKgS,aAEPH,aATJ,WAUM7R,KAAKkR,SAAW,IAAI1Q,EAA1B,4CAEIwR,UAZJ,WAYA,WACMhS,KAAKkR,SAAS1M,SACdxE,KAAKuN,SACL0E,uBAAsB,WACpB,EAAR,gBAGI1E,OAnBJ,WAoBMvN,KAAKmR,SAAS5D,OAAOvN,KAAKqR,MAAOrR,KAAKoR,SAExCO,aAtBJ,WAuBM,IAAN,mCACA,oCACM3R,KAAKmR,SAAW,IAAI,EAA1B,OACQd,OAAQrQ,KAAKkS,MAAMC,YAErBnS,KAAKmR,SAASiB,QAAQC,EAAGC,IAE3BV,WA9BJ,WA+BM,IAAN,mCACA,oCACM5R,KAAKoR,OAAS,IAAI,EAAxB,MACA,qBACA,IACA,mBACA,qBAGIU,UAxCJ,WAyCM9R,KAAKqR,MAAQ,IAAI,EAAvB,MAEM,IAAN,uBACMkB,EAAM9O,SAAS4C,IAAI,EAAG,EAAG,GAAGmM,YAC5BxS,KAAKqR,MAAMpL,IAAIsM,GAEf,IAAN,4BACMvS,KAAKqR,MAAMoB,IAAMA,EACjBzS,KAAKmR,SAASuB,cAAcD,EAAIE,MAAO,IAEzCZ,QAnDJ,SAmDA,gBACM,EAAN,+BACQ,IAAR,wBACQnD,EAAQgE,MAAQhE,EAAQiE,MAAQ,EAAxC,MACQjE,EAAQhP,OAAOyG,IAAIyM,EAAS5E,MAAO4E,EAAS3E,QAC5C,IAAR,aACQ2E,EAASnE,KAAK7I,MAAMgF,EAAI,GACxB,EAAR,aACQ,EAAR,4BACQ,EAAR,sBACQ,EAAR,6BACQ,EAAR,cACA,6CC3FqW,I,YCOjWiI,EAAY,eACd,EACAxF,EACAS,GACA,EACA,KACA,WACA,MAIa,aAAA+E,E","file":"js/chunk-eef6054a.bd684f49.js","sourcesContent":["'use strict';\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.repeat` method implementation\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author ScieCode / http://github.com/sciecode\n */\n\nimport {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from \"../../../build/three.module.js\";\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.05;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t// Touch fingers\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t} else {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t}\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t}\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.domElement.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: - 1,\n\t\tROTATE: 0,\n\t\tDOLLY: 1,\n\t\tPAN: 2,\n\t\tTOUCH_ROTATE: 3,\n\t\tTOUCH_PAN: 4,\n\t\tTOUCH_DOLLY_PAN: 5,\n\t\tTOUCH_DOLLY_ROTATE: 6\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateDelta = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\tvar needsUpdate = false;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.update();\n\n\t\t}\n\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\n\n\t}\n\n\tfunction handleTouchStartDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateEnd.set( x, y );\n\n\t\t}\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t}\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyIn( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t}\n\n\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t}\n\n\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\t// Prevent the browser from scrolling.\n\n\t\tevent.preventDefault();\n\n\t\t// Manually set the focus since calling preventDefault above\n\t\t// prevents the browser from setting it automatically.\n\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0:\n\n\t\t\t\tswitch ( scope.mouseButtons.LEFT ) {\n\n\t\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.mouseButtons.MIDDLE ) {\n\n\t\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.mouseButtons.RIGHT ) {\n\n\t\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\tscope.domElement.addEventListener( 'keydown', onKeyDown, false );\n\n\t// make sure element can receive keys.\n\n\tif ( scope.domElement.tabIndex === - 1 ) {\n\n\t\tscope.domElement.tabIndex = 0;\n\n\t}\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tOrbitControls.call( this, object, domElement );\n\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\tthis.touches.ONE = TOUCH.PAN;\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n","module.exports = __webpack_public_path__ + \"img/terrain.44a85d36.png\";","module.exports = __webpack_public_path__ + \"img/texture.307a27a4.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"container\",staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},style:({})})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as THREE from \"three\";\r\nclass Terrains {\r\n  constructor(width, height) {\r\n    this.width = width;\r\n    this.height = height;\r\n    this.geometry = new THREE.PlaneBufferGeometry(\r\n      width,\r\n      height,\r\n      width - 1,\r\n      height - 1\r\n    );\r\n    let rotation = new THREE.Matrix4().makeRotationX(-Math.PI / 2);\r\n    this.geometry.applyMatrix(rotation);\r\n    this.array = this.geometry.attributes.position.array;\r\n    this.mesh = null;\r\n  }\r\n  static fromImage(src) {\r\n    return new Promise(function(resolve, reject) {\r\n      let img = new Image();\r\n      img.onload = function() {\r\n        let width = img.width;\r\n        let height = img.height;\r\n        let canvas = document.createElement(\"canvas\");\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        let ctx = canvas.getContext(\"2d\");\r\n        ctx.drawImage(img, 0, 0);\r\n        let pixels = ctx.getImageData(0, 0, width, height).data;\r\n        let terrain = new Terrains(width, height);\r\n        for (let i = 0; i < width * height; i++) {\r\n          terrain.array[i * 3 + 1] = pixels[i * 4] / 256;\r\n        }\r\n        resolve(terrain);\r\n      };\r\n      img.onabort = reject;\r\n      img.onerror = reject;\r\n      img.src = src;\r\n    });\r\n  }\r\n\r\n  build(texture) {\r\n    this.geometry.computeBoundingSphere();\r\n    this.geometry.computeVertexNormals();\r\n    this.material = new THREE.MeshLambertMaterial({\r\n      map: texture\r\n    });\r\n    this.mesh = new THREE.Mesh(this.geometry, this.material);\r\n    this.mesh.position.x = this.width / 2;\r\n    this.mesh.position.z = this.height / 2;\r\n    return this.mesh;\r\n  }\r\n\r\n  getHeightAt(x, z) {\r\n    /*\r\n    Get height (y value) of terrain at x, z\r\n\r\n    Find which \"cell\" x, z is in by rounding them both down since each\r\n    height sample is evenly spaced at integer locations.\r\n\r\n    Once we have a cell (a location between four neighboring height samples)\r\n    we can figure out the offset by subtracting the rounded values from the\r\n    real values. This effectively gives us the amount \"into\" the cell we are\r\n    for both x and z.\r\n\r\n    rx = x - floor(z)\r\n    rz = z - floor(z)\r\n\r\n    a----b\r\n    |    |\r\n    |p   |\r\n    d----c\r\n\r\n    Using these fractional values, if our position is marked by the p, the\r\n    height can be found by first interpolating between (a->b) using rx, then\r\n    interpolating between (c->d) using rx, and then between the result of\r\n    both of those using rz.\r\n\r\n    y = (a * (1 - rx) + b * rx) * (1 - rz) + (c * rx + d * (1 - rx)) * rz\r\n    */\r\n    let width = this.width;\r\n    let height = this.height;\r\n    if (x < 0 || x >= width || z < 0 || z >= height) {\r\n      throw new Error(\"point outside of terrain boundary\");\r\n    }\r\n    // Get integer floor of x, z\r\n    let ix = Math.floor(x);\r\n    let iz = Math.floor(z);\r\n    // Get real (fractional) component of x, z\r\n    // This is the amount of each into the cell\r\n    let rx = x - ix;\r\n    let rz = z - iz;\r\n    // Edges of cell\r\n    let a = this.array[(iz * width + ix) * 3 + 1];\r\n    let b = this.array[(iz * width + (ix + 1)) * 3 + 1];\r\n    let c = this.array[((iz + 1) * width + (ix + 1)) * 3 + 1];\r\n    let d = this.array[((iz + 1) * width + ix) * 3 + 1];\r\n    // Interpolate top edge (left and right)\r\n    let e = a * (1 - rx) + b * rx;\r\n    // Interpolate bottom edge (left and right)\r\n    let f = c * rx + d * (1 - rx);\r\n    // Interpolate between top and bottom\r\n    let y = e * (1 - rz) + f * rz;\r\n    return y;\r\n  }\r\n}\r\nexport default Terrains;\r\n","<template>\r\n  <canvas ref=\"container\" style=\"width: 100%;height: 100%\" :style=\"{}\"></canvas>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from \"three\";\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport Terrains from \"@/page/three/plugins/Terrains\";\r\nexport default {\r\n  name: \"threeTerrain\",\r\n  data() {\r\n    return {\r\n      controll: null,\r\n      renderer: null,\r\n      camera: null,\r\n      scene: null,\r\n      path: require(\"@/page/three/plugins/terrain.png\"),\r\n      texture: require(\"@/page/three/plugins/texture.png\"),\r\n      cameraOpt: {\r\n        angle: 70,\r\n        min: 0.1,\r\n        max: 1000\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.initRenderer();\r\n      this.inirCamera();\r\n      this.initControll();\r\n      this.initScene();\r\n      this.addData(this.path, this.texture);\r\n      this.animation();\r\n    },\r\n    initControll() {\r\n      this.controll = new OrbitControls(this.camera, this.renderer.domElement);\r\n    },\r\n    animation() {\r\n      this.controll.update();\r\n      this.render();\r\n      requestAnimationFrame(() => {\r\n        this.animation();\r\n      });\r\n    },\r\n    render() {\r\n      this.renderer.render(this.scene, this.camera);\r\n    },\r\n    initRenderer() {\r\n      const w = this.$refs.container.clientWidth;\r\n      const h = this.$refs.container.clientHeight;\r\n      this.renderer = new THREE.WebGLRenderer({\r\n        canvas: this.$refs.container\r\n      });\r\n      this.renderer.setSize(w, h);\r\n    },\r\n    inirCamera() {\r\n      const w = this.$refs.container.clientWidth;\r\n      const h = this.$refs.container.clientHeight;\r\n      this.camera = new THREE.PerspectiveCamera(\r\n        this.cameraOpt.angle,\r\n        w / h,\r\n        this.cameraOpt.min,\r\n        this.cameraOpt.max\r\n      );\r\n    },\r\n    initScene() {\r\n      this.scene = new THREE.Scene();\r\n      // Let there be light\r\n      let light = new THREE.DirectionalLight(0xe0e0e0);\r\n      light.position.set(1, 1, 0).normalize();\r\n      this.scene.add(light);\r\n\r\n      let fog = new THREE.FogExp2(0x998877, 0.005);\r\n      this.scene.fog = fog;\r\n      this.renderer.setClearColor(fog.color, 1);\r\n    },\r\n    addData(demPath, texturePath) {\r\n      Terrains.fromImage(demPath).then(terrains => {\r\n        const texture = new THREE.TextureLoader().load(texturePath);\r\n        texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\r\n        texture.repeat.set(terrains.width, terrains.height);\r\n        const object3d = terrains.build(texture);\r\n        terrains.mesh.scale.y = 50.0;\r\n        this.scene.add(object3d);\r\n        this.camera.position.x = terrains.width / 2;\r\n        this.camera.position.y = 100;\r\n        this.camera.position.z = terrains.height / 2;\r\n        this.camera.lookAt(\r\n          new THREE.Vector3(terrains.width / 2, 100, terrains.height / 2)\r\n        );\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./threeTerrain.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./threeTerrain.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./threeTerrain.vue?vue&type=template&id=a1f4362a&scoped=true&\"\nimport script from \"./threeTerrain.vue?vue&type=script&lang=js&\"\nexport * from \"./threeTerrain.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a1f4362a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}